# Number 数字类型

## 目录

- [Number 数字类型](#number-数字类型)
  - [目录](#目录)
  - [Integer Literals](#integer-literals)
  - [Floating-Point Literals](#floating-point-literals)
    - [使用下划线将长字面值分解成更容易阅读的块](#使用下划线将长字面值分解成更容易阅读的块)
  - [Arithmetic in JavaScript](#arithmetic-in-javascript)
    - [JavaScript 算数注意点](#javascript-算数注意点)
      - [溢出 与 无穷值](#溢出-与-无穷值)
    - [下溢 与 -0](#下溢-与--0)
    - [除以0 与 返回无穷值](#除以0-与-返回无穷值)
    - [NaN 出现场景](#nan-出现场景)
  - [Number 对象](#number-对象)
    - [NaN 特性](#nan-特性)
    - [Number.isfinite() 与 Number.isNaN() 辨析](#numberisfinite-与-numberisnan-辨析)
    - [负零值的特性](#负零值的特性)

JavaScript 的主要数字类型 Number 用于表示整数和近似实数。

当一个数字直接出现在 JavaScript 程序中时，它被称为 数字文字。JavaScript 支持的几种格式的数字文字将在以下章节叙述。

**注**：任何数字文字前面都可以加一个减号（-），以使数字为负。

## Integer Literals

JavaScript 支持的整数表示

- 10 进制
  - 0、3、100000
- 16 进制
  - 以 0x 或 0X 为前缀，后面跟着一串十六进制数字
  - 0xff --> 255：（15 * 16 + 15）
  - 0XBADCFE --> 195939070

ES6 及后续版本新增支持的整数表示

- 2 进制
  - 以 0b 或 0B 为前缀
  - 0b10101 --> 21：（1*16 + 0*8 + 1*4 + 0*2 + 1*1）
- 8 进制
  - 以 0o 或 0O 为前缀
  - 0o377 --> 255：（3*64 + 7*8 + 7*1）

## Floating-Point Literals

浮点数有一个小数点，实数表示为数字的整数部分，然后是小数点和小数部分。

浮点数也可以用指数表示法表示：一个实数后面跟着字母 e（或 E），再跟着一个可选的符号 + （或符号 -），然后是一个整数指数。这个符号表示实数乘以10的指数次方。

语法为：

[digits][.digits][(E | e)\[(+ | -)]digits]

代码示例：

```javascript
3.14
2345.6789
.33333333
6.02e23        // 6.02 * 10^23
1.4738223E-32  // 1.4738223 * 10^-32
```

### 使用下划线将长字面值分解成更容易阅读的块

代码示例：

```javascript
let billion = 1_000_000_000;   // Underscore as a thousands separator.
let bytes = 0x89_AB_CD_EF;     // As a bytes spearator.
let bits = 0b0001_1101_0111;   // As a nibble separator.
let fraction = 0.123_456_789;  // Works in the fractional part, too.
```

2020年初，数字字面值中的下划线还没有作为 JavaScript 中的一部分正式标准化。但是它们处于标准化过程的高级阶段，所有主要浏览器和 Node 都实现了它们。

## Arithmetic in JavaScript

JavaScript 算数运算符

- 加法 +
- 减法 -
- 乘法 *
- 除法 /
- 取模 % （除后的余数）
- 取幂 ** （ES2016 添加）

JavaScript 通过定义 Math 对象属性的一组函数和常量支持更复杂的数学运算

ES5

```javascript
Math.pow(2,53);       // 2 的 53 次方。 2 to the power 53
Math.round(.6);       // 四舍五入取整
Math.ceil(.6);        // 向上取整
Math.floor(.6);       // 向下取整
Math.abs(-5);         // 取绝对值
Math.max(x, y, z);    // 取最大值（一组数，任意数量）
Math.min(x, y, z);    // 取最小值（一组数，任意数量）
Math.random();        // 取任意值（0 <= x < 1）
Math.PI               // π
Math.E                // e 自然对数的基数
Math.sqrt(3);         // 3**0.5 取平方根
Math.pow(3, 1/3);     // 3**(1/3) 取立方根
Math.sin(0);
Math.log(10);
Math.log(100)/Math.LN10
Math.log(512)/Math.LN2
Math.exp(3)
```

ES6

```javascript
Math.cbrt();      // 取立方根
Math.hypot(3,4);  // 勾股定理求值 square root of sum of square of all argunments
Math.log10(100);  // 2  Base-10 logarithm
Math.log2(1024);  // 10 Base-2 logarithm
Math.trunc(3.9);  // 3 直接去除小数点
....
```

### JavaScript 算数注意点

JavaScript 中的算术在溢出、下溢或除以 0 的情况下不会引发错误。

#### 溢出 与 无穷值

当数值操作的结果大于最大可表示数（溢出）时，结果是一个特殊的无穷值，即 infinity。

同理，当一个负数的绝对值大于最大可表示负数的绝对值时，结果是负无穷，即 -infinity。

无穷值加减乘除任何值都会产生无穷值（可能符号颠倒）。

### 下溢 与 -0

当数值操作的结果比最小的可表示的数字更接近于零时，就会发生**下溢**。

如果下溢发生在正数时，JavaScript 返回 0。

如果下溢发生在负数时，JavaScript 返回一个特殊值，称为负零（negative zero），这个值与普通的 0 几乎没有区别，JavaScript 程序员几乎不需要检测它。

### 除以0 与 返回无穷值

在 JavaScript 中除以 0 不是错误，会返回 infinity 或 -infinity。

**例外**，0 除以 0 没有一个定义良好的值，这个操作的结果是一个特殊的非数字值 NaN。

### NaN 出现场景

- 无穷除以无穷
- 取负数的平方根
- 使用带有不能转换为数字的非数字操作数的算数操作数

## Number 对象

JavaScript 预先定义了全局常量 Infinity 和 NaN 来保存正无穷值 和 非数字值，这些值也可以作为 Number 对象的属性。

```javascript
Infinity                      // A positive number too big to represent
Number.POSITIVE_INFINITY      // The same value
1/0                           // => Infinity
Number.MAX_VALUE * 2          // => Infinity; overflow

-Infinity                     // A negative number too big to represent
Number.NEGATIVE_INFINITY      // The same value
-1/0                          // => -Infinity
-Number.MAX_VALUE * 1         // => -Infinity

NaN                           // The not-a-number value
Number.NaN                    // The same value, written another way
0/0                           // => NaN
Infinity/Infinity             // => NaN

Number.MIN_VALUE / 2          // => 0 underflow 
-Number.MIN_VALUE / 2         // => -0 negative zero
-1 / Infinity                 // => -0 also negative 0
-0

// The following Number properties are defined in ES6
Number.parseInt()         // Same as the global parseInt() function
Number.parseFloat()       // Same as the global parseFloat() function
Number.isNaN(x)           // Is x the NaN value?
Number.isFinite(x)        // Is x a number and finite
Number.isInteger(x)       // Is x an integer?
Number.isSafeInteger(x)   // Is x an integer -(2**53) < x < (2**53)?
Number.MIN_SAFE_INTEGER   // -(2**53 - 1)
Number.MAX_SAFE_INTEGER   // 2**53 -1
Number.EPSILON            // 2**-52 smallest difference between numbers
```

### NaN 特性

not-a-number 值在 JavaScript 中有一个不同寻常的特性：**它不等于任何其他值，包括它自己**。

这意味着不能通过 x === NaN 来确定变量 x 是否为 NaN。

必须使用 x != x 或 Number.isNaN(x)，当且仅当 x 具有与全局常量 NaN 相同的值时，这些表达式将为真（true）。

### Number.isfinite() 与 Number.isNaN() 辨析

- Number.isNaN(x)
  - 如果参数 x 是 NaN，或 x 是一个不能转换为数字的非数字值，则返回 true
- Number.isfinite(x)
  - 如果参数 x 不是 NaN、Infinity、-Infinity，则返回 true

全局函数

- 全局函数 isNaN() 类似于 Number.isNaN()
- 全局函数 isfinite(x)
  - 如果参数 x 是一个有限数，或者可以转换为一个有限数，则返回 true

### 负零值的特性

-0 与 0 进行比较时，将返回 equal。（使用 JavaScript 严格相等进行测试）。

这意味着这两个值几乎无法区分，除非用作除数

```javascript
let zero = 0;       // Regular zero
let negz = -0;      // Negative zero
zero === negz;      // => true zero and negative zero are equal
1/zero === 1/negz;  // => false Infinity and -Infinity are not equal
````
